## mako

<%page expression_filter="h" args="online_help_token"/>

<%namespace name='static' file='../static_content.html'/>
<%!
from django.urls import reverse
from django.utils.translation import ugettext as _
from lms.djangoapps.ccx.overrides import get_current_ccx
from openedx.core.djangoapps.site_configuration import helpers as configuration_helpers
from openedx.features.enterprise_support.utils import get_enterprise_learner_generic_name, get_enterprise_learner_portal
from openedx.core.djangoapps.lang_pref.api import header_language_selector_is_enabled, released_languages

# App that handles subdomain specific branding
from lms.djangoapps.branding import api as branding_api
%>

<%
enterprise_customer_link = get_enterprise_learner_portal(request)
%>

<style>
  /*LANGUAGE FLAGS*/
  body footer.global {
    display: flex;
    background-color: rgba(3,48,85,1);
    font-size: .9em;
    color: #f7f7f7;
    overflow: hidden;
  }
  footer.global>.user{
    margin-top: 0px!important;
  }
  footer.global>.user>li{
    list-style-type: none;
  }
  .language-selector {
    display: none;
  }
  #lang-content {
    width: 60px;
    height: 24px;
  }
  #lang-content img{
    width: 25px;
  }
  body footer.global ul.links {
    padding-left: 40px;
    list-style: none;
    margin: 0;
    display: flex;
  }
  ul.links li {
    padding-right: 20px;
  }
  .copyright {
    display: none ;
  }
  body footer.global .footer-container {
    width: 100%;
    margin-left: auto;
    margin-right: auto;
    max-width: 1170px;
    padding: 20px;
  }
  a:not(.btn), a:visited:not(.btn) {
    color: var(--secondary) ;
  }
  a:not(.btn):hover, a:not(.btn):focus, a:visited:not(.btn):hover, a:visited:not(.btn):focus {
    color: var(--secondary) ;
  }
</style>

<style>
  .global-header {
    padding: 0 !important;
  }
</style>


<h1 class="header-logo">
  % if enterprise_customer_link:
    <a href="${settings.ENTERPRISE_LEARNER_PORTAL_BASE_URL}/${enterprise_customer_link.get('slug')}">
      <img class="logo" src="${enterprise_customer_link.get('logo')}" alt="${_('{name} Dashboard').format(name=enterprise_customer_link.get('name'))}"/>
    </a>

  % else:
    <a href="${branding_api.get_home_url()}">
      <%block name="navigation_logo">
        <img  class="logo" src="${branding_api.get_logo_url(is_secure)}" alt="${_("{platform_name} Home Page").format(platform_name=static.get_platform_name())}"/>
      </%block>
    </a>
    % if "/login" in request.path:
      <% languages = released_languages() %>
      <ol class="user footer-translation">
        <li class="primary">
          <form action="/i18n/setlang/" method="post" class="settings-language-form" id="language-settings-form">
            <input type="hidden" id="csrf_token" name="csrfmiddlewaretoken" value="${csrf_token}">
            % if user.is_authenticated:
            <input title="preference api" type="hidden" class="url-endpoint" value="${reverse('preferences_api', kwargs={'username': user.username})}" data-user-is-authenticated="true">
            % else:
            <input title="session update url" type="hidden" class="url-endpoint" value="${reverse('session_language')}" data-user-is-authenticated="false">
            % endif
            <label><span class="sr">${_("Choose Language")}</span>
              <!--LANGUAGE FLAGS-->
              <div id="lang-content">
                <!-- <img src="/media/microsite/afpa/images/uk.png" id="en"> -->
                <img src="${static.url('complete-data/images/uk.png')}" id="en">
                <img src="${static.url('complete-data/images/fr.png')}" id="fr">
                <!-- <img src="/media/microsite/afpa/images/fr.png" id="fr"> -->
                <select class="input select language-selector" id="settings-language-value" name="language" size="2" >
                  % for language in languages:
                    % if language[0] == LANGUAGE_CODE:
                      <option value="${language[0]}" selected="selected">${language[0]}</option>
                    % else:
                      <option value="${language[0]}">${language[0]}</option>
                    % endif
                  
                  % endfor
                </select>
              </div>
            </label>
          </form>
        </li>
      </ol>
    %endif
  % endif
</h1>
% if enable_enterprise_sidebar:
  <div class="enterprise-tagline">
    <% tagline = configuration_helpers.get_value('ENTERPRISE_TAGLINE', settings.ENTERPRISE_TAGLINE) %>
    % if tagline:
      ${tagline}
    % endif
  </div>
% endif


<script>
  $( document ).ready(function(){
    // console.log(window.location.pathname)
    
    if(window.location.pathname === "/"){
      $(".footer-translation").show();
    }else{
      $('footer.global').attr('style', 'padding: 20px 0px!important');
    }
    if($('#settings-language-value > option[value="en"]')[0] && $('#settings-language-value > option[value="en"]')[0].hasAttribute("selected")){
      $('#conf-trad').text('Privacy')
      $('#general-conditions').text('General conditions')
      $('#credits').text('Credits')
    } else{
      $('#about-trad').text('Mentions Légales')
      $('#conf-trad').text('Confidentialité')
      $('#general-conditions').text('Conditions générales')
      $('#credits').html('Cr&eacute;dits')
    }
  });
  </script>

<script>
  //LANGUAGE FLAGS
  $('header #en').on('click', function() {
    $('#settings-language-value > option[value="en"]').attr('selected','selected');
    $('#settings-language-value > option[value="fr"]').removeAttr('selected').trigger( "change");
  } );

  $('header #fr').on('click', function() {
    $('#settings-language-value > option[value="fr"]').attr('selected','selected');
    $('#settings-language-value > option[value="en"]').removeAttr('selected').trigger( "change");;
  } );
</script>
