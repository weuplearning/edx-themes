## mako

<%page expression_filter="h"/>
<%namespace name='static' file='../static_content.html'/>

<%!
import json
import six

from django.conf import settings
from django.utils.translation import ugettext as _
from django.template.defaultfilters import escapejs
from django.urls import reverse

from lms.djangoapps.discussion.django_comment_client.permissions import has_permission
from openedx.core.djangolib.js_utils import dump_js_escaped_json, js_escaped_string
from openedx.core.djangolib.markup import Text, HTML
from openedx.features.course_experience import DISABLE_UNIFIED_COURSE_TAB_FLAG, SHOW_REVIEWS_TOOL_FLAG
from openedx.features.course_experience.course_tools import HttpMethod

from lms.djangoapps.grades.course_grade import ZeroCourseGrade

from openedx.core.djangoapps.site_configuration import helpers as configuration_helpers
%>

<%block name="header_extras">
<link rel="stylesheet" type="text/css" href="${static.url('paragon/static/paragon.min.css')}" />
<link rel="stylesheet" type="text/css" href="${static.url('weup/css/animate-4.1.1.min.css')}" />
<style>

    :root {
        --primary : #007dff;
        --secondary: #FFF500 ; 
        --tertiary : #ED4D39;
        --charcoil : #334756;
    }
    .vertical-align, .horizontal-align {
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .vertical-align {
        flex-direction: column;
    }
    .page-content-container{
        border:none !important;
        background-color: unset;
    }
    .global-header.global-header{
        background: white !important; 
    }
    h4.subsection-title{
        font-size: 1rem;
    }
    button:focus {
        outline: none !important;
    }
    span.fa-pencil-square-o{
        display:none !important;
    }
    #expand-collapse-outline-all-button {
        display: none;
    }
    /* h2.hd.hd-3.page-title{
       color:white !important;
    } */
    #content {
        background-image: url("${static.url('umn/images/fond_page2.png')}");
        background-size: cover;
        margin-top: 0;
        padding: unset;
    }
    #top-line-banner {
        width: 100vw;
        height: 20px;
        background-size: cover;
        background-position: right;
        background-image: url("${static.url('umn/images/barre_couleurs.png')}");
    }



    /* Resume Progress */
    header.has-secondary {
        background-color: var(--charcoil);
        padding-top: 10px !important;
        padding-bottom: 10px !important;
        box-shadow: 0 3px 6px rgba(0,0,0,0.16);
        display: flex;
        flex-direction: column;
        align-items: center;
        flex-wrap: unset !important;
        background-image: url("${static.url('umn/images/bandeau_gris_img_passeport_nucleaire.png')}");
        background-size: cover;
        background-position-y: bottom;
        min-height: 160px;

    }
    .page-header-main {
        display: flex;
        justify-content: space-evenly;
        align-items: center;
        color: white;
        font-weight: 700;
        width: 80vw;
        height: 70%;
        padding-top: 25px;
    }
    #medal-first {
        height: 48px;
        width: 40px;
        margin-right:20px;
    }
    .page-header-main .progress_bar_and_score {
        width: 60%;
    }

    #final-grade-progress {
        height: 20px;
        width: 82%;
        padding: 0 !important;
    }

    #final-grade-progress .progress-bar-grade{
        background-color: var(--primary);
        border-radius: 7.5px;
        margin: 0 5px;
        overflow: hidden;
        height: 10px;
    }
    .completed_percent {
        font-size: 22px;
        font-family: 'Sora';
        font-weight: 800;
        margin-bottom: 0px !important;
    }
    .btn-secondary {
        background-color: unset !important;
        border: unset !important;
        color: white !important;
        font-weight: 700;
        background-image: url("${static.url('umn/images/bouton_commencer.svg')}");
        background-size: cover;
    }
    .page-header-secondary {
        margin-left: 150px !important;
        padding: 25px;
    }



    /* Section */
    .outline-button .fa {
        color: white !important;
        margin-right: 10px;
    }
    ol.block-tree > li {
        display: flex;
        align-items: flex-start;
        margin: 30px 120px !important;
        padding: 10px 17px !important;
        width: 80%;
        border-bottom: unset !important;
    }
    .vignette-section-img {
        height: 140px;
        width: 140px;
        margin-right: 20px;
        object-fit: cover;
    }
    .right-panel {
        display: flex;
        flex-direction: column;
        width: 100%;
    }    
    .accordion-trigger  {
        background-color: var(--primary) !important;
        color: white;
    }
    .section-name {
        height: 140px;
        padding: 20px 10px 20px 40px !important;
    }
    .fa-chevron-right {
        float: right;
    }
    .accordion-panel  {
        padding: 10px !important;
        background-color: white;
        border: 2px solid var(--charcoil);
        border-top: unset;
    }
    a.outline-button:hover {
        color: var(--tertiary);
        text-decoration: unset !important;
    }
    .accordion-panel h4 {
        color: inherit;
        font-size: 20px;
    }
    .subsection {
        border: none !important;
        margin: 0 10px;
    }
    .progress_bar_and_score {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 10px;
    }
    a.btn.btn-primary{
        display: none !important;
    }
    .progress-bar-full {
        width: 76%;
        background-color: white;
        position: relative;
        margin: 10px 20px 10px 0 ;
        display: flex;
        flex-direction: row;
        /* justify-content: center; */
        align-items: center;
        height: 13px;
        overflow: hidden;
    }

    #checkmark-finish {
        background-image: url("${static.url('umn/images/check_blanc.png')}");
    }
    #checkmark-finish-sub {
        background-image: url("${static.url('umn/images/check_grise.png')}");
        position: absolute;
        right: 10px;
    }
    #checkmark-finish, #checkmark-ongoing, #checkmark-finish-sub {
        height: 30px;
        width: 30px;
        background-size: cover;
    }
    /* .finish {
        display: flex;
        justify-content: space-between;
        align-items: center;
    } */
</style>

<style>
/* Animated Progress Bar */
.progress-bar-full {
    height: 20px;  
    position: relative;
    padding: 10px;
}

.progress-bar-full > span {
    display: block;
    height: 10px;
    border-radius: 3px;
    background-color: var(--charcoil);
    position: relative;
    overflow: hidden;
}
.progress-bar-full > span:after, .animate > span > span {
    content: "";
    position: absolute;
    top: 0; left: -50px; bottom: 0; right: 0;
    background-image: linear-gradient(
        -45deg, 
        rgba(255, 255, 255, 0.4) 25%, 
        transparent 25%, 
        transparent 50%, 
        rgba(255, 255, 255, 0.4) 50%, 
        rgba(255, 255, 255, 0.4) 75%, 
        transparent 75%, 
        transparent
    );
    background-size: 50px 50px;
    animation: move 2s linear infinite;
    z-index: 1;
    overflow: hidden;
}
.animate > span:after {
    display: none;
}

@keyframes move {
    0% {
        transform: translateX(0);
    }
    100% {
        transform: translateX(50px);
    }
}
.finish .progress-bar-full > span:after, .finish .animate > span > span {
    animation: unset;
    background-image: none;
}
</style>

<!-- %if request.path == '/courses/course-v1:umn+pn+02/course/' or request.path == '/courses/course-v1:umn+test+test/course/' : -->
<style>
ol> li:last-child .accordion-trigger {
    background-color: var(--charcoil) !important;
}
ol> li:last-child .progress-bar-full > span {
    background-color: red;
}
</style>
<!-- %endif -->

<style>

@media screen and (max-width: 768px) {
    .page-content .page-content-main { 
        min-width: 100%;
        max-width: 100%;
    }
    .page-content {
        flex-direction: column;
    }
    .page-header-main {
        flex-direction: column;
    }
    ol.block-tree > li {
        margin : 20px !important;
        flex-direction: column;
    }
    .progress_bar_and_score {
        flex-direction: column;
    }
    header.has-secondary {
        min-height: 250px ;
    }
    .page-header-secondary {
        margin: 0px !important;
    }
    #checkmark-finish {
        display: none;
    }
    .vignette-section-img {
        width: 100%;
        margin-bottom: 10px;
    }
}
@media screen and (max-width: 425px) {
    .page-content {
        padding: 0px !important;
    }
    ol.block-tree > li {
        margin : 0px !important;
        padding: 10px 0px !important;
    }
    .accordion-trigger {
        min-height: 160px;
    }
    a.outline-button {
        height: unset;
    }
    .section-title {
        padding-left: 0px !important ;
    }
}
</style>


<script>
document.title = "Cours | ${HTML(course.display_name_with_default)}";
</script>

</%block>


<%block name="content">

<div id="top-line-banner"></div>
<div class="course-view page-content-container" id="course-container">
    <header class="page-header has-secondary">
        <div class="page-header-main">
            <div class="horizontal-align header-medal-title">
                <img id="medal-first" src="${static.url('umn/images/medaille.png')}" alt="mÃ©daille">
                <p style="max-width: 350px;margin: 0;" > ${course.display_name}</p>
            </div>
            <div class="progress_bar_and_score">

                <div class="progress-bar-full " id="final-grade-progress">
                    <div style="width:${int(user_grade.percent * 100)}%;" class="progress-bar-grade" ></div>                        
                </div>
                <h2 class="completed_percent"> ${int(user_grade.percent * 100)} %</h2>     
            </div>


        </div>
        <div class="page-header-secondary" >
            <div class="form-actions">
                % if resume_course_url:
                    <a class="btn btn-secondary action-resume-course" href="${resume_course_url}">
                        % if has_visited_course:
                            <span data-action-type="resume">${_("Resume Course")}</span>
                        % else:
                            <span data-action-type="start">${_("Start Course")}</span>
                        % endif
                    </a>
                % endif
            </div>
        </div>
    </header>
    <div class="page-content">
        <div class="page-content-main">
            % if offer_banner_fragment:
                ${HTML(offer_banner_fragment.content)}
            % endif
            % if course_expiration_fragment:
                ${HTML(course_expiration_fragment.content)}
            % endif
            % if course_home_message_fragment:
                ${HTML(course_home_message_fragment.body_html())}
            % endif

            % if update_message_fragment and not DISABLE_UNIFIED_COURSE_TAB_FLAG.is_enabled(course.id):
                <div class="section section-update-message">
                    ${HTML(update_message_fragment.body_html())}
                </div>
            % endif

            % if outline_fragment:
                ${HTML(outline_fragment.body_html())}
            % endif
        </div>
    </div>
    % if course_sock_fragment:
        ${HTML(course_sock_fragment.body_html())}
    % endif
</div>
</%block>

<%static:webpack entry="CourseHome">
    new CourseHome({
        courseRunKey: "${course_key | n, js_escaped_string}",
        resumeCourseLink: ".action-resume-course",
        courseToolLink: ".course-tool-link",
        goalApiUrl: "${goal_api_url | n, js_escaped_string}",
        username: "${username | n, js_escaped_string}",
        courseId: "${course.id | n, js_escaped_string}",
    });
</%static:webpack>

<%static:webpack entry="Enrollment">
    new CourseEnrollment('.enroll-btn', '${course_key | n, js_escaped_string}');
</%static:webpack>

<%static:require_module_async module_name="js/commerce/track_ecommerce_events" class_name="TrackECommerceEvents">

  var personalizedLearnerSchedulesLink = $(".personalized_learner_schedules_button");
  var fbeLink = $("#FBE_banner");
  var welcomeLink = $("#welcome");
  var sockLink = $("#sock");
  var upgradeDateLink = $("#course_home_dates");
  var GreenUpgradeLink = $("#green_upgrade");
  var courseToolsUpgradeLink = $(document.querySelectorAll("[data-analytics-id='edx.tool.verified_upgrade']"));
  var GreenUpgradeLink = $("#green_upgrade");
  var certificateUpsellLink = $("#certificate_upsell");

    TrackECommerceEvents.trackUpsellClick(personalizedLearnerSchedulesLink, 'course_home_upgrade_shift_dates', {
      pageName: "course_home",
      linkType: "button",
      linkCategory: "personalized_learner_schedules"
    });

    TrackECommerceEvents.trackUpsellClick(fbeLink, 'course_home_audit_access_expires', {
      pageName: "course_home",
      linkType: "link",
      linkCategory: "FBE_banner"
    });

    TrackECommerceEvents.trackUpsellClick(welcomeLink, 'course_home_welcome', {
      pageName: "course_home",
      linkType: "link",
      linkCategory: "welcome"
    });

    TrackECommerceEvents.trackUpsellClick(sockLink, 'course_home_sock', {
      pageName: "course_home",
      linkType: "button",
      linkCategory: "green_upgrade"
    });

    TrackECommerceEvents.trackUpsellClick(upgradeDateLink, 'course_home_dates', {
      pageName: "course_home",
      linkType: "link",
      linkCategory: "(none)"
    });

    TrackECommerceEvents.trackUpsellClick(GreenUpgradeLink, 'course_home_green', {
      pageName: "course_home",
      linkType: "button",
      linkCategory: "green_upgrade"
    });

    TrackECommerceEvents.trackUpsellClick(courseToolsUpgradeLink, 'course_home_course_tools', {
      pageName: "course_home",
      linkType: "link",
      linkCategory: "(none)"
    });

    TrackECommerceEvents.trackUpsellClick(certificateUpsellLink, 'course_home_certificate', {
        pageName: "course_home",
        linkType: "link",
        linkCategory: "(none)"
      });

</%static:require_module_async> 
